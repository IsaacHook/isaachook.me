<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Hugo 0.31.1" />
    <meta name="description" content="">
<meta name="author" content="Isaac Hook">

    <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link rel="icon" href="/images/favicon.png" type="image/x-icon" />

    <title> :: Isaac Hook</title>
    
    
    <link href="/css/nucleus.css?1513999207" rel="stylesheet">
    <link href="/css/font-awesome.min.css?1513999207" rel="stylesheet">
    <link href="/css/hybrid.css?1513999207" rel="stylesheet">
    <link href="/css/featherlight.min.css?1513999207" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1513999207" rel="stylesheet">
    <link href="/css/auto-complete.css?1513999207" rel="stylesheet">
    <link href="/css/theme.css?1513999207" rel="stylesheet">
    <link href="/css/hugo-theme.css?1513999207" rel="stylesheet">
    

    <script src="/js/jquery-2.x.min.js?1513999207"></script>
    
    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{ 
          display:none !important;
      }
      
    </style>
    

<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-74396515-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>


  </head>
  <body class="" data-url="/iris/iris/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fa fa-search"></i></label>
    <input data-search-input id="search-by" type="text" placeholder="Search...">
    <span data-search-clear=""><i class="fa fa-close"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1513999207"></script>
<script type="text/javascript" src="/js/auto-complete.js?1513999207"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/isaachook.me";
    
</script>
<script type="text/javascript" src="/js/search.js?1513999207"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/wifi-projects/" title=" Wifi Projects" class="dd-item 
        
        
        
        ">
      <a href="/wifi-projects/">
          <i class='fa fa-wifi'></i> Wifi Projects
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/wifi-projects/hello-world-with-the-esp8266/" title="Hello World with the ESP8266" class="dd-item ">
        <a href="/wifi-projects/hello-world-with-the-esp8266/">
        Hello World with the ESP8266
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/wifi-projects/uploading-arduino-ide-to-esp8266/" title="Uploading the Arduino IDE to the ESP8266" class="dd-item ">
        <a href="/wifi-projects/uploading-arduino-ide-to-esp8266/">
        Uploading the Arduino IDE to the ESP8266
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/wifi-projects/understanding-how-the-internet-works/" title="Understanding the how the Internet Works" class="dd-item ">
        <a href="/wifi-projects/understanding-how-the-internet-works/">
        Understanding the how the Internet Works
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/wifi-projects/wifi-salt-lamp/" title="Wifi Salt Lamp (Part 1)" class="dd-item ">
        <a href="/wifi-projects/wifi-salt-lamp/">
        Wifi Salt Lamp (Part 1)
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/circuit-design/" title=" Circuit Design" class="dd-item 
        
        
        
        ">
      <a href="/circuit-design/">
          <i class='fa fa-microchip'></i> Circuit Design
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/circuit-design/bjts/" title="Some Title" class="dd-item ">
        <a href="/circuit-design/bjts/">
        Some Title
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/probability/" title=" Probability" class="dd-item 
        
        
        
        ">
      <a href="/probability/">
          <i class='fa fa-balance-scale'></i> Probability
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/probability/random-variables/" title="Random Variables" class="dd-item ">
        <a href="/probability/random-variables/">
        Random Variables
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/cs231n/" title=" CS231n" class="dd-item 
        
        
        
        ">
      <a href="/cs231n/">
          <i class='fa fa-eye' aria-hidden='true'></i> CS231n
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/cs231n/taking-the-derivative-of-the-softmax/" title="Taking the derivative of the softmax function" class="dd-item ">
        <a href="/cs231n/taking-the-derivative-of-the-softmax/">
        Taking the derivative of the softmax function
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/iris/" title="Iris" class="dd-item 
        parent
        
        
        ">
      <a href="/iris/">
          Iris
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/iris/iris/" title="" class="dd-item active">
        <a href="/iris/iris/">
        
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fa fa-heart"></i></a> from <a href="http://getgrav.org">Grav</a> and <a href="http://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fa fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
                  
                  <span class="links">
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Isaac Hook</a> > <a href='/iris/'>Iris</a> > 
          
         
          
         
          
           
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li><a href="#iris-dataset">Iris Dataset</a></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            

        
        <div id="body-inner">
          
            <h1></h1>
          

        




<h1 id="iris-dataset">Iris Dataset</h1>

<p>The code below learns to classify irises using the input data.
- Data is imported
- Basic exploration is done
- The data is visualized
- And then split into training and validation sets
- Multiple models are trained on the data
- The best model is selected and used to predict categories for new irises</p>

<pre><code class="language-python"># Import libraries
%matplotlib inline

import numpy as np

import seaborn as sns

import pandas
from pandas.tools.plotting import scatter_matrix
from pandas.tools.plotting import radviz
from pandas.tools.plotting import parallel_coordinates
from pandas.tools.plotting import bootstrap_plot
from pandas.tools.plotting import andrews_curves

import matplotlib.pyplot as plt
from sklearn import cross_validation
from sklearn.metrics import classification_report
from sklearn.metrics import confusion_matrix
from sklearn.metrics import accuracy_score
from sklearn.linear_model import LogisticRegression
from sklearn.tree import DecisionTreeClassifier
from sklearn.neighbors import KNeighborsClassifier
from sklearn.discriminant_analysis import LinearDiscriminantAnalysis
from sklearn.naive_bayes import GaussianNB
from sklearn.svm import SVC
</code></pre>

<pre><code class="language-python"># Load dataset
url = &quot;https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data&quot;
names = ['sepal-length', 'sepal-width', 'petal-length', 'petal-width', 'class']
dataset = pandas.read_csv(url, names=names)
</code></pre>

<pre><code class="language-python"># Explore the data
print 'Shape: %s' % (dataset.shape,)
print

print 'Head'
print '- - - - - - - - - - - - - - - - - - - - '
print dataset.head(20)
print

print 'Description'
print '- - - - - - - - - - - - - - - - - - - - '
print dataset.describe()
print

print 'Size of Classes'
print '- - - - - - - - - - - - - - - - - - - - '
print dataset.groupby('class').size()
print
</code></pre>

<pre><code>Shape: (150, 5)

Head
- - - - - - - - - - - - - - - - - - - - 
    sepal-length  sepal-width  petal-length  petal-width        class
0            5.1          3.5           1.4          0.2  Iris-setosa
1            4.9          3.0           1.4          0.2  Iris-setosa
2            4.7          3.2           1.3          0.2  Iris-setosa
3            4.6          3.1           1.5          0.2  Iris-setosa
4            5.0          3.6           1.4          0.2  Iris-setosa
5            5.4          3.9           1.7          0.4  Iris-setosa
6            4.6          3.4           1.4          0.3  Iris-setosa
7            5.0          3.4           1.5          0.2  Iris-setosa
8            4.4          2.9           1.4          0.2  Iris-setosa
9            4.9          3.1           1.5          0.1  Iris-setosa
10           5.4          3.7           1.5          0.2  Iris-setosa
11           4.8          3.4           1.6          0.2  Iris-setosa
12           4.8          3.0           1.4          0.1  Iris-setosa
13           4.3          3.0           1.1          0.1  Iris-setosa
14           5.8          4.0           1.2          0.2  Iris-setosa
15           5.7          4.4           1.5          0.4  Iris-setosa
16           5.4          3.9           1.3          0.4  Iris-setosa
17           5.1          3.5           1.4          0.3  Iris-setosa
18           5.7          3.8           1.7          0.3  Iris-setosa
19           5.1          3.8           1.5          0.3  Iris-setosa

Description
- - - - - - - - - - - - - - - - - - - - 
       sepal-length  sepal-width  petal-length  petal-width
count    150.000000   150.000000    150.000000   150.000000
mean       5.843333     3.054000      3.758667     1.198667
std        0.828066     0.433594      1.764420     0.763161
min        4.300000     2.000000      1.000000     0.100000
25%        5.100000     2.800000      1.600000     0.300000
50%        5.800000     3.000000      4.350000     1.300000
75%        6.400000     3.300000      5.100000     1.800000
max        7.900000     4.400000      6.900000     2.500000

Size of Classes
- - - - - - - - - - - - - - - - - - - - 
class
Iris-setosa        50
Iris-versicolor    50
Iris-virginica     50
dtype: int64
</code></pre>

<pre><code class="language-python"># Visualize data - Pandas
dataset.plot(kind='box', subplots=True, layout=(2,2), sharex=False, sharey=False)
plt.suptitle('Box plots of dataset columns')

dataset.hist()
plt.suptitle('Histogram of dataset columns')

scatter_matrix(dataset)
plt.suptitle('Comparison of each column with each other')
plt.show()


    
radviz(dataset,'class')
plt.suptitle('Radviz')
plt.show()

parallel_coordinates(dataset, 'class')
plt.suptitle('Parallel Coordinates')
plt.show()

bootstrap_plot(dataset['sepal-length'], size=5, samples=500, color='grey')
plt.suptitle('Bootstrap Plot')
plt.show()

andrews_curves(dataset, 'class')
plt.suptitle('Andrews Curves')
plt.show()
</code></pre>

<p><img src="/images/iris_files/output_4_0.png" alt="png" /></p>

<p><img src="output_4_1.png" alt="png" /></p>

<p><img src="output_4_2.png" alt="png" /></p>

<p><img src="output_4_3.png" alt="png" /></p>

<p><img src="output_4_4.png" alt="png" /></p>

<p><img src="output_4_5.png" alt="png" /></p>

<p><img src="output_4_6.png" alt="png" /></p>

<pre><code class="language-python"># Visualize data - Seaborn

# Scatter Plot
g = sns.pairplot(dataset, hue='class', palette='Set2', diag_kind='kde')
plt.suptitle('Scattered data with categories coloured')
plt.show()

# Box plot
plt.figure()
sns.boxplot(data=dataset, whis=np.inf, color=&quot;c&quot;, orient='h')
sns.stripplot(data=dataset, jitter=True, size=3, color=&quot;.3&quot;, linewidth=0, orient='h')
plt.suptitle('Horizontal box plot data')
plt.show()
</code></pre>

<p><img src="/images/Iris_files/output_5_0.png" alt="png" /></p>

<p><img src="output_5_1.png" alt="png" /></p>

<pre><code class="language-python"># Split dataset
array =  dataset.values
X = array[:, 0:4]
Y = array[:, 4]
validation_size = 0.2
seed = 7
X_train, X_val, Y_train, Y_val = cross_validation.train_test_split(X, Y, test_size=validation_size, random_state=seed)

num_folds = 10
num_instances = len(X_train)
seed = 7
scoring = 'accuracy'
</code></pre>

<pre><code class="language-python"># Select best model
models = []
models.append((('LR'), LogisticRegression()))
models.append((('LDA'), LinearDiscriminantAnalysis()))
models.append((('KNN'), KNeighborsClassifier()))
models.append((('CART'), DecisionTreeClassifier()))
models.append((('NB'), GaussianNB()))
models.append((('SVM'), SVC()))

results = []
names = []
for name, model in models:
    kfold = cross_validation.KFold(n=num_instances, n_folds=num_folds, random_state=seed)
    cv_results = cross_validation.cross_val_score(model, X_train, Y_train, cv=kfold, scoring=scoring)
    results.append(cv_results)
    names.append(name)
    msg = &quot;%s: %f (%f)&quot; % (name, cv_results.mean(), cv_results.std())
    print msg
</code></pre>

<pre><code>LR: 0.966667 (0.040825)
LDA: 0.975000 (0.038188)
KNN: 0.983333 (0.033333)
CART: 0.966667 (0.040825)
NB: 0.975000 (0.053359)
SVM: 0.991667 (0.025000)
</code></pre>

<pre><code class="language-python"># Box plot of results
fig = plt.figure()
fig.suptitle('Algorithm Comparison')
ax = fig.add_subplot(111)
plt.boxplot(results)
ax.set_xticklabels(names)
plt.show()
</code></pre>

<p><img src="output_8_0.png" alt="png" /></p>

<pre><code class="language-python"># Test model on validation set
knn = KNeighborsClassifier()
knn.fit(X_train, Y_train)
predictions = knn.predict(X_val)
print 'Accuract Score: %f' % accuracy_score(Y_val, predictions)
print

print 'Confusion Matrix'
print '- - - - - - - - - - - - - - - - - - - - '
print confusion_matrix(Y_val, predictions)
print 

print 'Classification Report'
print '- - - - - - - - - - - - - - - - - - - - '
print classification_report(Y_val, predictions)

X_train = X_train[:, 0:2]
knn.fit(X_train, Y_train)
X_val = X_val[:, 0:2]
predictions = knn.predict(X_val)
h = .02  # step size in the mesh
</code></pre>

<pre><code>Accuract Score: 0.900000

Confusion Matrix
- - - - - - - - - - - - - - - - - - - - 
[[ 7  0  0]
 [ 0 11  1]
 [ 0  2  9]]

Classification Report
- - - - - - - - - - - - - - - - - - - - 
             precision    recall  f1-score   support

Iris-setosa       1.00      1.00      1.00         7
Iris-versicolor       0.85      0.92      0.88        12
Iris-virginica       0.90      0.82      0.86        11

avg / total       0.90      0.90      0.90        30
</code></pre>

<pre><code class="language-python"># print dataset['sepal-length']
x_min, x_max = dataset['sepal-length'].min() - 1, dataset['sepal-length'].max() + 1
print x_min, x_max
</code></pre>

<pre><code>3.3 8.9
</code></pre>

<pre><code class="language-python"># create a mesh to plot in
x_min, x_max = dataset['sepal-length'].min() - 1, dataset['sepal-length'].max() + 1
y_min, y_max = dataset['sepal-width'].min() - 1, dataset['sepal-width'].max() + 1
xx, yy = np.meshgrid(np.arange(x_min, x_max, h),
                     np.arange(y_min, y_max, h))

# for i, clf in enumerate(knn):
# Plot the decision boundary. For that, we will assign a color to each
# point in the mesh [x_min, x_max]x[y_min, y_max].
# plt.subplot(2, 2, i + 1)
# plt.subplots_adjust(wspace=0.4, hspace=0.4)

Z = knn.predict(np.c_[xx.ravel(), yy.ravel()])
Z = np.where(Z=='Iris-versicolor',0,Z)
Z = np.where(Z=='Iris-virginica',1,Z)
Z = np.where(Z=='Iris-setosa',2,Z)

W = dataset['class']
W = np.where(W=='Iris-versicolor',0,W)
W = np.where(W=='Iris-virginica',1,W)
W = np.where(W=='Iris-setosa',2,W)

# Put the result into a color plot
Z = Z.reshape(xx.shape)
plt.contourf(xx, yy, Z, cmap=plt.cm.coolwarm, alpha=0.8)

# Plot also the training points
plt.scatter(dataset['sepal-length'], dataset['sepal-width'], c=W, cmap=plt.cm.coolwarm)
plt.xlabel('Sepal length')
plt.ylabel('Sepal width')
plt.xlim(xx.min(), xx.max())
plt.ylim(yy.min(), yy.max())
plt.xticks(())
plt.yticks(())

plt.show()
</code></pre>

<p><img src="output_11_0.png" alt="png" /></p>

<pre><code class="language-python">
</code></pre>


<footer class=" footline" >
	
</footer>


        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


        
            <a class="nav nav-prev" href="/iris/" title="Iris"> <i class="fa fa-chevron-left"></i></a>
        
        
            <a class="nav nav-next" href="/wifi-projects/" title=" Wifi Projects" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
        
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1513999207"></script>
    <script src="/js/perfect-scrollbar.min.js?1513999207"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1513999207"></script>
    <script src="/js/jquery.sticky.js?1513999207"></script>
    <script src="/js/featherlight.min.js?1513999207"></script>
    <script src="/js/html5shiv-printshiv.min.js?1513999207"></script>
    <script src="/js/highlight.pack.js?1513999207"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom.71422.js?1513999207"></script>
    <script src="/js/learn.js?1513999207"></script>
    <script src="/js/hugo-learn.js?1513999207"></script>

    <link href="/mermaid/mermaid.css?1513999207" type="text/css" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1513999207"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    


  </body>
</html>

